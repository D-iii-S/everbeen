<!DOCTYPE html>

<html t:type="layout" section="section"
      xmlns:t="http://tapestry.apache.org/schema/tapestry_5_3.xsd" xmlns:p="tapestry:parameter">

    <h2>Task ${itemId}</h2>
    <t:if t:test="task" t:negate="true">
        Task ${itemId} was not found
        <p:else>
            <div style="float: right; text-align: right;">
                <button class="btn btn-success" onclick="location.href='/task/logs/${task.id}'; return false;">Show task
                    logs
                </button>
                <br/>
                <br/>
                <button class="btn btn-success" onclick="location.href='/task/history/${task.id}'; return false;">State
                    change history
                </button>
                <br/>
                <br/>
                <t:if test="isTaskInFinalState(task.id)">
                    <button class="btn btn-warning"
                            onclick="if (window.confirm('Are you sure?')) location.href='/task/remove/${task.id}'; return false;">
                        Remove task
                    </button>
                    <p:else>
                        <button class="btn btn-danger"
                                onclick="if (window.confirm('Are you sure?')) location.href='/task/kill/${task.id}'; return false;">
                            Kill task
                        </button>
                    </p:else>
                </t:if>
            </div>

            <dl class="dl-horizontal">
                <dt>Task ID:</dt>
                <dd>
                    <i class="icon-beaker"></i>&nbsp;
                    <b>${task.id}</b>
                </dd>
                <dt>Name:</dt>
                <dd>
                    <b>${task.taskDescriptor.name}</b>
                </dd>

                <dt>State:</dt>
                <dd>
                    <t:task.stateIcon taskState="task.state"/>
                </dd>
                <dt>Type:</dt>
                <dd>${task.taskDescriptor.type}</dd>
                <dt>BPK package:</dt>
                <dd>${task.taskDescriptor.groupId}, ${task.taskDescriptor.bpkId}, ${task.taskDescriptor.version}</dd>
                <dt>Last changed:</dt>
                <dd>${taskLastChanged(task)}</dd>
            </dl>

            <dl class="dl-horizontal">
                <dt>Owner ID:</dt>
                <dd>${task.ownerId}</dd>

                <dt>Runtime ID:</dt>
                <dd>
                    <t:if test="task.runtimeId">
                        <i class="icon-laptop"></i>&nbsp;
                        <a href="/runtime/detail/${task.runtimeId}">
                            <t:output format="idFormat" value="task.runtimeId"/>
                        </a>
                    </t:if>
                </dd>

                <dt>Task Context ID:</dt>
                <dd>
                    <i class="icon-book"></i>&nbsp;
                    <a href="/context/detail/${task.taskContextId}">
                        <t:output format="idFormat" value="task.taskContextId"/>
                    </a>
                </dd>

                <dt>Benchmark ID:</dt>
                <dd>
                    <t:if test="task.benchmarkId">
                        <i class="icon-rocket"></i>&nbsp;
                        <a href="/benchmark/detail/${task.benchmarkId}">
                            <t:output format="idFormat" value="task.benchmarkId"/>
                        </a>
                    </t:if>
                </dd>
            </dl>

            <dl class="dl-horizontal">
                <dt>Exit code:</dt>
                <dd>${task.exitCode}</dd>
                <dt>Working directory:</dt>
                <dd>${task.workingDirectory}</dd>
                <dt>Task dependency:</dt>
                <dd>${task.taskDependency}</dd>

                <dt>Args:</dt>
                <dd>
                    <t:loop source="task.args?.arg" value="arg">
                        ${arg}
                        <br/>
                    </t:loop>
                </dd>

                <dt>Description:</dt>
                <dd>${task.taskDescriptor.description}</dd>
                <dt>Long description:</dt>
                <dd>${task.taskDescriptor.longDescription}</dd>

                <dt>Exclusive:</dt>
                <dd>${task.taskDescriptor.exclusive}</dd>

                <dt>Properties:</dt>
                <dd>
                    <t:loop source="task.taskDescriptor.properties.property" value="property">
                        ${property.name} = ${property.value}
                        <br/>
                    </t:loop>
                </dd>

                <dt>Debug:</dt>
                <dd>
                    ${taskDebugToString(task.taskDescriptor.debug)}
                </dd>
            </dl>
        </p:else>
    </t:if>

</html>
